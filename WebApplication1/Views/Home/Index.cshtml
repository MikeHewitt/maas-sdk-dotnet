@{
    ViewBag.Title = "Home Page";
}
<div class="jumbotron">
    <h1>Welcome to Miracl</h1>
    <h2>Sample client application</h2>
</div>
<div class="row">
    <div class="col-md-8">

        @using (Html.BeginForm())
        {
            if (User.Identity.IsAuthenticated)
            {
                <button name="Logout" id="LogoutId" title="Test" value="Logout" >Logout</button>
            }
            else
            {
                <div class="inner cover">
                    <p class="lead">Please login to access the miracle world of Miracl.</p>
                    <p class="lead">
                        <a id="btmpin" href="#" class="btn btn-lg btn-default" onclick="javascript:onSubmitButtonClick(); return false;" data-uri="@ViewBag.AuthorizationUri">Login with M-Pin</a>
                    </p>
                    <p><label class="small"><input type="checkbox" onclick='$("#newuser").toggle()' /> Predefine username</label></p>
                    <p><input id="newuser" style="color:black;display:none" /></p>
                </div>

                @Scripts.Render("~/Scripts/mpin.js")

                <script type="text/javascript" language="javascript">
                    function onSubmitButtonClick() {
                        var b = document.getElementById("btmpin");
                        var atr = b.getAttribute("data-uri");
                        var prerollId = $("#newuser").val();
                        mpin.login({
                            authURL: atr,
                            prerollId: prerollId
                        });
                    }
                </script>
            }
        }

        <br />
        <br />
        <br />

        <div class="col-md-10">
            <h3>Identity</h3>
            @if (User.Identity.IsAuthenticated)
            {
                <p>
                    <dl>
                        @foreach (var claim in System.Security.Claims.ClaimsPrincipal.Current.Claims)
                        {
                            <dt>@claim.Type</dt>
                            <dd>@claim.Value</dd>
                        }
                    </dl>
                </p>
            }
            else
            {
                <p>
                    anonymous.
                </p>
            }
        </div>
    </div>
</div>